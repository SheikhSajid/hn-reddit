{"version":3,"sources":["utils/getTopPosts.js","Components/Post/PostContent.jsx","Components/PostsList/PostEntry.jsx","Components/PostsList/PostList.jsx","Components/Post/Comment.jsx","Components/Post/Comments.jsx","utils/getComments.js","Components/Post/SortDropdown.jsx","Components/Post/CommentsContainer.jsx","Components/Post/FullPost.jsx","App.js","serviceWorker.js","index.js"],"names":["fetchPosts","allPostIds","key","a","pagesFetchedSoFar","idsToFetch","slice","reqs","forEach","id","req","fetch","push","Promise","all","responses","jsonPromises","map","res","json","posts","fetchTopPostIds","then","fetchPost","_","response","post","by","descendants","score","time","title","text","url","timestamp","distanceInWordsToNow","Date","addSuffix","urlShortened","textShortened","hnUrl","length","stopBubbling","useCallback","event","stopPropagation","copyToClipboard","navigator","clipboard","writeText","alert","catch","err","console","error","startsWith","className","href","target","rel","onClick","dangerouslySetInnerHTML","__html","memo","handleClick","openHNPageInNewTab","PostContent","history","useHistory","pathname","state","dataLength","next","hasMore","loader","style","width","endMessage","PostEntry","comment","created_at","author","children","useState","childrenHidden","setChildrenHidden","showHideChildren","Comments","comments","Comment","usePostComments","commentsRef","useRef","useQuery","args","getComments","staleTime","data","isLoading","option","updater","current","oldComments","commentsCopy","sort","cmt1","cmt2","created_at_i","sortCommentsImpl","queryCache","setQueryData","fetchFullPost","DropdownMenu","clickHandler","options","selectedOption","color","undefined","sortComments","setSelectedOption","handler","postId","loading","SortDropdown","marginLeft","props","match","params","shouldFetch","location","enabled","top","left","paddingLeft","fetched","CommentsContainer","App","topPostIds","useInfiniteQuery","getFetchMore","lastGroup","allGroups","postsArray","isFetchingMore","fetchMore","flat","useTopPosts","path","component","FullPost","PostList","Boolean","window","hostname","ReactDOM","render","document","getElementById","serviceWorker","ready","registration","unregister","message"],"mappings":"sSA0BeA,E,gFAAf,WAA0BC,EAAYC,GAAtC,qCAAAC,EAAA,6DAA2CC,EAA3C,+BAA+D,EACvDC,EAAaJ,EAAWK,MACR,GAApBF,EACoB,GAApBA,EAAyB,IAGrBG,EAAO,GAEbF,EAAWG,SAAQ,SAACC,GAClB,IAAMC,EAAMC,MAAM,8CAAD,OAA+CF,EAA/C,UACjBF,EAAKK,KAAKF,MAVd,SAa0BG,QAAQC,IAAIP,GAbtC,cAaQQ,EAbR,OAcQC,EAAeD,EAAUE,KAAI,SAACC,GAAD,OAASA,EAAIC,UAdlD,UAesBN,QAAQC,IAAIE,GAflC,eAeQI,EAfR,yBAiBSA,GAjBT,6C,sBAoBA,SAASC,IACP,OAAOV,MACL,yDACAW,MAAK,SAACJ,GAAD,OAASA,EAAIC,UAGf,SAAeI,EAAtB,oC,4CAAO,WAAyBC,EAAGf,GAA5B,iBAAAN,EAAA,sEACkBQ,MAAM,8CAAD,OACoBF,EADpB,UADvB,cACCgB,EADD,gBAIcA,EAASN,OAJvB,cAICO,EAJD,yBAKEA,GALF,4C,iDCjDQ,cAAe,IAAZA,EAAW,EAAXA,KACRC,EAAuDD,EAAvDC,GAAIC,EAAmDF,EAAnDE,YAAanB,EAAsCiB,EAAtCjB,GAAIoB,EAAkCH,EAAlCG,MAAOC,EAA2BJ,EAA3BI,KAAMC,EAAqBL,EAArBK,MAAOC,EAAcN,EAAdM,KAAMC,EAAQP,EAARO,IAEjDC,EAAYC,YAAqB,IAAIC,KAAY,IAAPN,GAAc,CAC5DO,WAAW,IAETC,EAAe,GACfC,EAAgB,GACdC,EAAK,+CAA2C/B,GAElDuB,GAAQA,EAAKS,OAAS,MACxBF,EAAgBP,EAAK1B,MAAM,EAAG,KAAO,MACrCiC,GAAa,iJAGgBC,EAHhB,8FASf,IAAME,EAAeC,uBAAY,SAACC,GAAD,OAAWA,EAAMC,oBAAmB,CAACZ,IAEhEa,EAAkBH,uBACtB,SAACC,GACCA,EAAMC,kBACNE,UAAUC,UACPC,UAAUhB,GACVX,MAAK,kBAAM4B,MAAM,eAAD,OAAgBjB,OAChCkB,OAAM,SAACC,GAAD,OAASC,QAAQC,MAAMF,QAElC,CAACnB,IAmBH,OAhBIA,IAW6B,OAJ/BK,GAHAA,GAHAA,EAAeL,EAAIsB,WAAW,YAC1BtB,EAAI3B,MAAM,EAAG,IACb2B,EAAI3B,MAAM,EAAG,KACWiD,WAAW,WACnCjB,EAAahC,MAAM,EAAG,IACtBgC,EAAahC,MAAM,EAAG,KACEiD,WAAW,QACnCjB,EAAahC,MAAM,GACnBgC,EAAahC,MAAM,IAENA,OAAO,KACtBgC,EAAeA,EAAahC,MAAM,GAAI,IACpC2B,EAAIQ,OAAS,KAAIH,GAAgB,QAIrC,kBAAC,WAAD,KACE,yBAAKkB,UAAU,cACb,6BAAM3B,GACN,uCAGF,yBAAK2B,UAAU,gBACb,yBAAKA,UAAU,iBAAf,aACa7B,EADb,IACkBO,GAElB,wBAAIsB,UAAU,cAAczB,GAC5B,yBAAKyB,UAAU,aACZvB,GACC,uBACEwB,KAAMxB,EACNyB,OAAO,UACPC,IAAI,sBACJH,UAAU,gBACVI,QAASlB,GAERJ,GAGJN,GACC,yBACEwB,UAAU,YACVK,wBAAyB,CAAEC,OAAQvB,MAKzC,yBAAKiB,UAAU,eACb,6BAAM5B,EAAN,aACA,yBAAKgC,QAASd,GAAd,aACA,qCACA,yCCtFKiB,kBAAK,YAA4B,IAAzBrC,EAAwB,EAAxBA,KAAMsC,EAAkB,EAAlBA,YACrBC,EAAqBtB,uBAAY,SAACC,GACtCA,EAAMC,kBACNmB,EAAYtC,KACX,IAEH,OACE,yBAAKkC,QAASK,EAAoBT,UAAU,uBAC1C,kBAACU,EAAD,CAAaxC,KAAMA,QCLVqC,kBAAK,YAA4B,IAAzB3C,EAAwB,EAAxBA,MAAOpB,EAAiB,EAAjBA,WAGxBmE,EAAUC,cAERJ,EAAcrB,uBAClB,SAACjB,GACCyC,EAAQvD,KAAK,CAAEyD,SAAS,mBAAD,OAAqB3C,EAAKjB,IAAM6D,MAAO,CAAE5C,YAElE,CAACyC,IAGH,OACE,kBAAC,IAAD,CACEI,WAAYnD,EAAMqB,OAClB+B,KAAMxE,EACNyE,QAASrD,EAAMqB,QAAU,IACzBiC,OAAQ,0CACRC,MAAO,CAAEC,MAAO,SAChBC,WACE,2BACE,0DAIHzD,EAAMH,KAAI,SAACS,GAAD,OACT,kBAACoD,EAAD,CAAWpD,KAAMA,EAAMsC,YAAaA,WC5B7B,cAAkB,IAAfe,EAAc,EAAdA,QACRC,EAAuCD,EAAvCC,WAAYC,EAA2BF,EAA3BE,OAAQjD,EAAmB+C,EAAnB/C,KAAMkD,EAAaH,EAAbG,SAC5BhD,EAAYC,YAAqB,IAAIC,KAAK4C,GAAa,CAC3D3C,WAAW,IAHiB,EAMc8C,oBAAS,GANvB,mBAMvBC,EANuB,KAMPC,EANO,KAQxBC,EAAmB3C,uBAAY,WACf0C,GAAhBD,KAEH,CAACC,IAEJ,OACE,yBAAK7B,UAAU,8CACX4B,GACA,yBACExB,QAAS0B,EACT9B,UAAU,mDAEV,yBAAKA,UAAU,gBAInB,yBAAKA,UAAU,mBACb,yBACEI,QAAS,kBAAMyB,GAAkB,IACjC7B,UAAU,oBAET4B,GAAkB,MAClBH,EALH,SAKc/C,IAGZkD,GACA,yBACE5B,UAAU,eACVK,wBAAyB,CAAEC,OAAQ9B,MAIrCoD,KAAoBF,EAASzC,QAC7B,kBAAC8C,EAAD,CAAUC,SAAUN,OC1Cf,cAA0B,IAAvBM,EAAsB,EAAtBA,SAAUb,EAAY,EAAZA,MAC1B,OACE,yBAAKA,MAAOA,EAAOnB,UAAU,YAC1BgC,EAASvE,KAAI,SAAC8D,GAAD,OACZ,kBAACU,EAAD,CAASvF,IAAK6E,EAAQtE,GAAIsE,QAASA,S,QCJpC,SAASW,EAAgBjF,GAC9B,IAAMkF,EAAcC,iBAAO,IADO,EAGIC,YACpC,CAAC,mBAAoBpF,IACrB,sCAAIqF,EAAJ,yBAAIA,EAAJ,uBAAaC,EAAW,WAAX,EAAeD,EAAf,QAAqBH,OAClC,CACEK,UAAW,OAgBf,MAAO,CAvB2B,EAG1BC,KAH0B,EAGVC,UAQH,SAACC,GACpB,IAAIC,EAGFA,EADa,YAAXD,EACQ,kBAAMR,EAAYU,SAElB,SAACC,GAAD,OA0BhB,SAA0BH,EAAQX,GAChC,IAAMe,EAAY,YAAOf,GAEzB,OAAQW,GACN,IAAK,SACHI,EAAaC,MAAK,SAACC,EAAMC,GAAP,OAAgBA,EAAKC,aAAeF,EAAKE,gBAC3D,MACF,IAAK,SACHJ,EAAaC,MAAK,SAACC,EAAMC,GAAP,OAAgBD,EAAKE,aAAeD,EAAKC,gBAC3D,MACF,QACE,OAAOnB,EAGX,OAAOe,EAxCwBK,CAAiBT,EAAQG,IAGtDO,IAAWC,aAAa,CAAC,mBAAoBrG,GAAK2F,K,SAMvCL,E,kFAAf,WAA2B7F,EAAKO,EAAIkF,GAApC,iBAAAxF,EAAA,sEACqB4G,EAActG,GADnC,cACQiB,EADR,OAEQ8D,EAAW9D,EAAKwD,SAGlBS,IAAaA,EAAYU,QAAUb,GALzC,kBAOSA,GAPT,4C,sBAUO,SAAeuB,EAAtB,kC,4CAAO,WAA6BtG,GAA7B,iBAAAN,EAAA,sEACkBQ,MAAM,uCAAD,OAAwCF,IAD/D,cACCgB,EADD,gBAEcA,EAASN,OAFvB,cAECO,EAFD,yBAIEA,GAJF,4C,sBCnCP,IAAMsF,EAAe,SAAC,GAA+C,IAA7CC,EAA4C,EAA5CA,aAAcC,EAA8B,EAA9BA,QAASC,EAAqB,EAArBA,eAC7C,OACE,yBAAK3D,UAAU,2BACb,wBAAIA,UAAU,iBACX0D,EAAQjG,KAAI,SAACkF,GACZ,IAAMxB,EACJwB,IAAWgB,EACP,CAAEC,MAAO,6BACTC,EACN,OACE,wBAAI1C,MAAOA,EAAOzE,IAAKiG,EAAQvC,QAAS,kBAAMqD,EAAad,KACxDA,SASA,cAAuB,IAApBmB,EAAmB,EAAnBA,aAAmB,EAQSnC,mBAAS,WARlB,mBAQ5BgC,EAR4B,KAQZI,EARY,KAU7BC,EAAU7E,uBACd,SAACwD,GACCoB,EAAkBpB,GAClBmB,EAAanB,KAEf,CAACoB,EAAmBD,IAGtB,OACE,yBAAK9D,UAAU,yBAAf,UAEE,yBAAKA,UAAU,sBACb,8BAAO2D,GACP,kBAAC,EAAD,CACEF,aAAcO,EACdN,QAxBQ,CAEd,UACA,SACA,UAqBMC,eAAgBA,OC7CX,cAAiB,IAAD,EACazB,EADb,EAAb+B,QAAa,mBACtBjC,EADsB,KACZkC,EADY,KACHJ,EADG,KAG7B,OACE,kBAAC,WAAD,MACII,GAAW,kBAACC,EAAD,CAAcL,aAAcA,KACvCI,GACA,kBAACnC,EAAD,CAAUZ,MAAO,CAAEiD,WAAY,SAAWpC,SAAUA,IAErDkC,GAAW,qDCRH,WAACG,GAAW,IACjBpH,EAAOoH,EAAMC,MAAMC,OAAnBtH,GACFuH,IAAgBH,EAAMI,SAAS3D,OAASuD,EAAMI,SAAS3D,MAAM5C,MAF3C,EAIQmE,YAAS,CAAC,OAAQpF,GAAKc,EAAW,CAChE2G,QAASF,EACThC,UAAW,OAFDtE,EAJY,EAIlBuE,KAAYC,EAJM,EAINA,UAOlB,OAFK8B,GAAgBtG,IAAMA,EAAOmG,EAAMI,SAAS3D,MAAM5C,MAGrD,yBACEiD,MAAO,CAKLwD,IAAK,EACLC,KAAM,EACNC,YAAa,QAEf7E,UAAU,qBAETwE,GAAe9B,GAAa,0CAC5BxE,GAAQ,kBAACwC,EAAD,CAAaxC,KAAMA,EAAM4G,QAASN,IAC1CtG,GAAQ,kBAAC6G,EAAD,CAAmBd,OAAQ/F,EAAKjB,GAAI6H,QAASN,MCT7CQ,MAhBf,WAAgB,IAAD,EVJR,WAAuB,IAEdC,EAAe5C,YAAS,aAAcxE,EAAiB,CACnE2E,UAAW,OADLC,KAFoB,EAM4ByC,YACtD,YACA,sCAAI5C,EAAJ,yBAAIA,EAAJ,uBAAa9F,EAAU,WAAV,GAAWyI,GAAc,IAAzB,OAAgC3C,MAC7C,CACE6C,aAAc,SAACC,EAAWC,GAExB,OADYA,EAAUpG,OAAS,IAAMoG,EAAUpG,YAAS,GAG1DyF,QAASO,EACTzC,UAAW,OATD8C,EANc,EAMpB7C,KAAkB8C,EANE,EAMFA,eAAgBC,EANd,EAMcA,UAc1C,MAAO,CADOF,EAAaA,EAAWG,OAAS,GAChCF,EAAgBC,GUfME,GADxB,mBACN9H,EADM,KACUpB,GADV,WAGb,OACE,yBAAKwD,UAAU,OACb,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAO2F,KAAK,sBAAsBC,UAAWC,IAE7C,kBAAC,IAAD,CAAOF,KAAK,KACV,kBAACG,EAAD,CAAUlI,MAAOA,EAAOpB,WAAYA,Q,QCJ1BuJ,QACW,cAA7BC,OAAOvB,SAASwB,UAEe,UAA7BD,OAAOvB,SAASwB,UAEhBD,OAAOvB,SAASwB,SAAS3B,MACvB,2DCXN4B,IAASC,OACP,kBAAC,IAAD,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,SDwHpB,kBAAmB9G,WACrBA,UAAU+G,cAAcC,MACrBzI,MAAK,SAAA0I,GACJA,EAAaC,gBAEd9G,OAAM,SAAAG,GACLD,QAAQC,MAAMA,EAAM4G,c","file":"static/js/main.9edcc617.chunk.js","sourcesContent":["// import { useRef } from 'react';\r\nimport { useInfiniteQuery, useQuery } from 'react-query';\r\n\r\nexport function useTopPosts() {\r\n  // Fetch the IDs of the Top Stories\r\n  const { data: topPostIds } = useQuery('topPostIds', fetchTopPostIds, {\r\n    staleTime: 1000 * 60 * 3 /* 3 minutes */,\r\n  });\r\n\r\n  const { data: postsArray, isFetchingMore, fetchMore } = useInfiniteQuery(\r\n    'topPosts',\r\n    (...args) => fetchPosts(topPostIds || [], ...args),\r\n    {\r\n      getFetchMore: (lastGroup, allGroups) => {\r\n        const ret = allGroups.length < 500 ? allGroups.length : void 0;\r\n        return ret;\r\n      },\r\n      enabled: topPostIds, // Pause until IDs are loaded\r\n      staleTime: 1000 * 60 * 3 /* 3 minutes */,\r\n    }\r\n  );\r\n\r\n  const posts = postsArray ? postsArray.flat() : [];\r\n  return [posts, isFetchingMore, fetchMore];\r\n}\r\n\r\nasync function fetchPosts(allPostIds, key, pagesFetchedSoFar = 0) {\r\n  const idsToFetch = allPostIds.slice(\r\n    pagesFetchedSoFar * 30,\r\n    pagesFetchedSoFar * 30 + 30\r\n  );\r\n\r\n  const reqs = [];\r\n\r\n  idsToFetch.forEach((id) => {\r\n    const req = fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`);\r\n    reqs.push(req);\r\n  });\r\n\r\n  const responses = await Promise.all(reqs);\r\n  const jsonPromises = responses.map((res) => res.json());\r\n  const posts = await Promise.all(jsonPromises);\r\n\r\n  return posts;\r\n}\r\n\r\nfunction fetchTopPostIds() {\r\n  return fetch(\r\n    'https://hacker-news.firebaseio.com/v0/topstories.json'\r\n  ).then((res) => res.json());\r\n}\r\n\r\nexport async function fetchPost(_, id) {\r\n  const response = await fetch(\r\n    `https://hacker-news.firebaseio.com/v0/item/${id}.json`\r\n  );\r\n  const post = await response.json();\r\n  return post;\r\n}\r\n","import React, { Fragment, useCallback } from 'react';\r\nimport distanceInWordsToNow from 'date-fns/formatDistanceToNow';\r\n\r\nexport default ({ post }) => {\r\n  const { by, descendants, id, score, time, title, text, url } = post;\r\n\r\n  const timestamp = distanceInWordsToNow(new Date(time * 1000), {\r\n    addSuffix: true,\r\n  });\r\n  let urlShortened = '';\r\n  let textShortened = '';\r\n  const hnUrl = `https://news.ycombinator.com/item?id=${id}`;\r\n\r\n  if (text && text.length > 900) {\r\n    textShortened = text.slice(0, 900) + '...';\r\n    textShortened += `<br />\r\n                      <a target=\"_blank\" \r\n                         rel=\"noopener noreferrer\"\r\n                         href='${hnUrl}'\r\n                      >\r\n                        Read more\r\n                      </a>`;\r\n  }\r\n\r\n  const stopBubbling = useCallback((event) => event.stopPropagation(), [url]);\r\n\r\n  const copyToClipboard = useCallback(\r\n    (event) => {\r\n      event.stopPropagation();\r\n      navigator.clipboard\r\n        .writeText(url)\r\n        .then(() => alert(`URL copied: ${url}`))\r\n        .catch((err) => console.error(err));\r\n    },\r\n    [url]\r\n  );\r\n\r\n  if (url) {\r\n    urlShortened = url.startsWith('https://')\r\n      ? url.slice(8, 33)\r\n      : url.slice(0, 25);\r\n    urlShortened = urlShortened.startsWith('http://')\r\n      ? urlShortened.slice(7, 32)\r\n      : urlShortened.slice(0, 25);\r\n    urlShortened = urlShortened.startsWith('www.')\r\n      ? urlShortened.slice(4)\r\n      : urlShortened.slice(0);\r\n\r\n    if (urlShortened.slice(-1) === '/')\r\n      urlShortened = urlShortened.slice(0, -1);\r\n    if (url.length > 33) urlShortened += '...';\r\n  }\r\n\r\n  return (\r\n    <Fragment>\r\n      <div className=\"like-count\">\r\n        <div>{score}</div>\r\n        <div>Likes</div>\r\n      </div>\r\n\r\n      <div className=\"post-content\">\r\n        <div className=\"post-metadata\">\r\n          Posted by {by} {timestamp}\r\n        </div>\r\n        <h2 className=\"post-title\">{title}</h2>\r\n        <div className=\"post-body\">\r\n          {url && (\r\n            <a\r\n              href={url}\r\n              target=\"_blanks\"\r\n              rel=\"noopener noreferrer\"\r\n              className=\"url-shortened\"\r\n              onClick={stopBubbling}\r\n            >\r\n              {urlShortened}\r\n            </a>\r\n          )}\r\n          {text && (\r\n            <div\r\n              className=\"post-text\"\r\n              dangerouslySetInnerHTML={{ __html: textShortened }}\r\n            ></div>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"post-bottom\">\r\n          <div>{descendants} Comments</div>\r\n          <div onClick={copyToClipboard}>Copy Link</div>\r\n          <div>Save</div>\r\n          <div>Hide</div>\r\n        </div>\r\n      </div>\r\n    </Fragment>\r\n  );\r\n};\r\n","import React, { memo, useCallback } from 'react';\r\nimport PostContent from '../Post/PostContent';\r\n\r\nexport default memo(({ post, handleClick }) => {\r\n  const openHNPageInNewTab = useCallback((event) => {\r\n    event.stopPropagation();\r\n    handleClick(post);\r\n  }, []);\r\n\r\n  return (\r\n    <div onClick={openHNPageInNewTab} className=\"post postlist-entry\">\r\n      <PostContent post={post} />\r\n    </div>\r\n  );\r\n});\r\n","import React, { memo, useCallback } from 'react';\r\nimport InfiniteScroll from 'react-infinite-scroll-component';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nimport PostEntry from './PostEntry';\r\n\r\nexport default memo(({ posts, fetchPosts }) => {\r\n  // TODO: Replace 'react-infinite-scroll-component' package (uses the deprecated\r\n  //       componentWillReceiveProps) with 'react-infinite-scroller'\r\n  let history = useHistory();\r\n\r\n  const handleClick = useCallback(\r\n    (post) => {\r\n      history.push({ pathname: `/hn-reddit/post/${post.id}`, state: { post } });\r\n    },\r\n    [history]\r\n  );\r\n\r\n  return (\r\n    <InfiniteScroll\r\n      dataLength={posts.length}\r\n      next={fetchPosts}\r\n      hasMore={posts.length <= 500}\r\n      loader={<h4>Loading...</h4>}\r\n      style={{ width: '640px' }}\r\n      endMessage={\r\n        <p>\r\n          <b>Yay! You have seen it all</b>\r\n        </p>\r\n      }\r\n    >\r\n      {posts.map((post) => (\r\n        <PostEntry post={post} handleClick={handleClick} />\r\n      ))}\r\n    </InfiniteScroll>\r\n  );\r\n});\r\n","import React, { useState, useCallback } from 'react';\r\nimport distanceInWordsToNow from 'date-fns/formatDistanceToNow';\r\nimport Comments from './Comments';\r\n\r\nexport default ({ comment }) => {\r\n  const { created_at, author, text, children } = comment;\r\n  const timestamp = distanceInWordsToNow(new Date(created_at), {\r\n    addSuffix: true,\r\n  });\r\n\r\n  const [childrenHidden, setChildrenHidden] = useState(false);\r\n\r\n  const showHideChildren = useCallback(() => {\r\n    if (childrenHidden) setChildrenHidden(false);\r\n    else setChildrenHidden(true);\r\n  }, [setChildrenHidden]);\r\n\r\n  return (\r\n    <div className=\"comment-container comment-container-outer\">\r\n      {!childrenHidden && (\r\n        <div\r\n          onClick={showHideChildren}\r\n          className=\"threadline-container threadline-container-outer\"\r\n        >\r\n          <div className=\"threadline\"></div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"comment-content\">\r\n        <div\r\n          onClick={() => setChildrenHidden(false)}\r\n          className=\"comment-metadata\"\r\n        >\r\n          {childrenHidden && '[+]'}\r\n          {author} · {timestamp}\r\n        </div>\r\n\r\n        {!childrenHidden && (\r\n          <div\r\n            className=\"comment-body\"\r\n            dangerouslySetInnerHTML={{ __html: text }}\r\n          ></div>\r\n        )}\r\n\r\n        {!childrenHidden && !!children.length && (\r\n          <Comments comments={children} />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport Comment from './Comment';\r\n\r\nexport default ({ comments, style }) => {\r\n  return (\r\n    <div style={style} className=\"comments\">\r\n      {comments.map((comment) => (\r\n        <Comment key={comment.id} comment={comment} />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n","import { useRef } from 'react';\r\nimport { useQuery, queryCache } from 'react-query';\r\n\r\nexport function usePostComments(id) {\r\n  const commentsRef = useRef([]);\r\n\r\n  const { data: comments, isLoading } = useQuery(\r\n    ['postWithComments', id],\r\n    (...args) => getComments(...args, commentsRef),\r\n    {\r\n      staleTime: 1000 * 60 * 3 /* 3 minutes */,\r\n    }\r\n  );\r\n\r\n  const sortComments = (option) => {\r\n    let updater;\r\n\r\n    if (option === 'Default') {\r\n      updater = () => commentsRef.current;\r\n    } else {\r\n      updater = (oldComments) => sortCommentsImpl(option, oldComments);\r\n    }\r\n\r\n    queryCache.setQueryData(['postWithComments', id], updater);\r\n  };\r\n\r\n  return [comments, isLoading, sortComments];\r\n}\r\n\r\nasync function getComments(key, id, commentsRef) {\r\n  const post = await fetchFullPost(id);\r\n  const comments = post.children;\r\n\r\n  // store the default order of comments from the server in a ref\r\n  if (commentsRef) commentsRef.current = comments;\r\n\r\n  return comments;\r\n}\r\n\r\nexport async function fetchFullPost(id) {\r\n  const response = await fetch(`https://hn.algolia.com/api/v1/items/${id}`);\r\n  const post = await response.json();\r\n\r\n  return post;\r\n}\r\n\r\nfunction sortCommentsImpl(option, comments) {\r\n  const commentsCopy = [...comments];\r\n\r\n  switch (option) {\r\n    case 'Newest':\r\n      commentsCopy.sort((cmt1, cmt2) => cmt2.created_at_i - cmt1.created_at_i);\r\n      break;\r\n    case 'Oldest':\r\n      commentsCopy.sort((cmt1, cmt2) => cmt1.created_at_i - cmt2.created_at_i);\r\n      break;\r\n    default:\r\n      return comments;\r\n  }\r\n\r\n  return commentsCopy;\r\n}\r\n","import React from 'react';\r\nimport { useState } from 'react';\r\nimport { useCallback } from 'react';\r\n\r\nconst DropdownMenu = ({ clickHandler, options, selectedOption }) => {\r\n  return (\r\n    <div className=\"dropdown-menu-container\">\r\n      <ul className=\"dropdown-menu\">\r\n        {options.map((option) => {\r\n          const style =\r\n            option === selectedOption\r\n              ? { color: 'var(--orange-accent)' }\r\n              : undefined;\r\n          return (\r\n            <li style={style} key={option} onClick={() => clickHandler(option)}>\r\n              {option}\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ({ sortComments }) => {\r\n  const options = [\r\n    // 'Most Points',\r\n    'Default',\r\n    'Newest',\r\n    'Oldest',\r\n    // 'Least Points',\r\n  ];\r\n  const [selectedOption, setSelectedOption] = useState('Default');\r\n\r\n  const handler = useCallback(\r\n    (option) => {\r\n      setSelectedOption(option);\r\n      sortComments(option);\r\n    },\r\n    [setSelectedOption, sortComments]\r\n  );\r\n\r\n  return (\r\n    <div className=\"sort-comment-dropdown\">\r\n      Sort By\r\n      <div className=\"dropdown-container\">\r\n        <span>{selectedOption}</span>\r\n        <DropdownMenu\r\n          clickHandler={handler}\r\n          options={options}\r\n          selectedOption={selectedOption}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { Fragment } from 'react';\r\nimport Comments from './Comments';\r\nimport { usePostComments } from '../../utils/getComments';\r\nimport SortDropdown from './SortDropdown';\r\n\r\nexport default ({ postId }) => {\r\n  const [comments, loading, sortComments] = usePostComments(postId);\r\n\r\n  return (\r\n    <Fragment>\r\n      {!loading && <SortDropdown sortComments={sortComments} />}\r\n      {!loading && (\r\n        <Comments style={{ marginLeft: '-20px' }} comments={comments} />\r\n      )}\r\n      {loading && <h1>Loading Comments...</h1>}\r\n    </Fragment>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport CommentsContainer from './CommentsContainer';\r\nimport PostContent from './PostContent';\r\nimport { useQuery } from 'react-query';\r\nimport { fetchPost } from '../../utils/getTopPosts';\r\n\r\nexport default (props) => {\r\n  const { id } = props.match.params;\r\n  const shouldFetch = !(props.location.state && props.location.state.post);\r\n\r\n  let { data: post, isLoading } = useQuery(['post', id], fetchPost, {\r\n    enabled: shouldFetch,\r\n    staleTime: 1000 * 60 * 3 /* 3 minutes */,\r\n  });\r\n\r\n  if (!shouldFetch && !post) post = props.location.state.post;\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        // TODO: Move inline styles to global CSS\r\n        // height: '100%',\r\n        // backgroundColor: '#F6F6EF',\r\n        // position: 'absolute',\r\n        top: 0,\r\n        left: 0,\r\n        paddingLeft: '40px',\r\n      }}\r\n      className=\"post post-display\"\r\n    >\r\n      {shouldFetch && isLoading && <h1>Loading...</h1>}\r\n      {post && <PostContent post={post} fetched={shouldFetch} />}\r\n      {post && <CommentsContainer postId={post.id} fetched={shouldFetch} />}\r\n    </div>\r\n  );\r\n};\r\n","import React from 'react';\r\nimport './App.css';\r\nimport { useTopPosts } from './utils/getTopPosts';\r\nimport PostList from './Components/PostsList/PostList';\r\nimport { Switch, Route } from 'react-router-dom';\r\nimport FullPost from './Components/Post/FullPost';\r\n\r\nfunction App() {\r\n  const [posts, loading, fetchPosts] = useTopPosts(30);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Switch>\r\n        <Route path=\"/hn-reddit/post/:id\" component={FullPost} />\r\n\r\n        <Route path=\"/\">\r\n          <PostList posts={posts} fetchPosts={fetchPosts} />\r\n        </Route>\r\n      </Switch>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport { BrowserRouter as Router } from 'react-router-dom';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n  <Router>\r\n    <App />\r\n  </Router>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}